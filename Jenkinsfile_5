pipeline {
    agent any

    triggers {
        cron('H/2 * * * *') // Run every 5 minutes, adjust as needed
    }

    stages {
        stage('Check for Changes') {
            steps {
                script {
                    def changes = checkout poll: false, scm: scmGit(branches: [[name: '*/master']], extensions: [], userRemoteConfigs: [[credentialsId: '290205a2-d519-45ae-90d3-0e23209e2c29', url: 'ssh://']])

                    if (changes.isEmpty()) {
                        echo "No changes found. Exiting pipeline."
                        currentBuild.result = 'SUCCESS'
                        return
                    } else {
                        echo "Changes detected. Proceeding to the 'Build and Test' stage."
                    }
                }
            }
        }

        stage('Build and Test') {
            steps {
                echo "Building and testing..."
                // Add your build and test commands here
                //comment
            }
        }

        stage('Deploy') {
            steps {
                echo "Deploying..."
                // Add your deployment commands here
            }
        }
    }
}
